function ut(t,e){return function(){return t.apply(e,arguments)}}const{toString:Ut}=Object.prototype,{getPrototypeOf:Fe}=Object,{iterator:Se,toStringTag:lt}=Symbol,Ee=(t=>e=>{const r=Ut.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),z=t=>(t=t.toLowerCase(),e=>Ee(e)===t),ke=t=>e=>typeof e===t,{isArray:se}=Array,ne=ke("undefined");function ue(t){return t!==null&&!ne(t)&&t.constructor!==null&&!ne(t.constructor)&&j(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ft=z("ArrayBuffer");function Lt(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&ft(t.buffer),e}const Bt=ke("string"),j=ke("function"),dt=ke("number"),le=t=>t!==null&&typeof t=="object",Ft=t=>t===!0||t===!1,ye=t=>{if(Ee(t)!=="object")return!1;const e=Fe(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(lt in t)&&!(Se in t)},jt=t=>{if(!le(t)||ue(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Mt=z("Date"),qt=z("File"),$t=z("Blob"),Wt=z("FileList"),Ht=t=>le(t)&&j(t.pipe),zt=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||j(t.append)&&((e=Ee(t))==="formdata"||e==="object"&&j(t.toString)&&t.toString()==="[object FormData]"))},Kt=z("URLSearchParams"),[Gt,xt,Vt,Jt]=["ReadableStream","Request","Response","Headers"].map(z),Xt=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fe(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,s;if(typeof t!="object"&&(t=[t]),se(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{if(ue(t))return;const i=r?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(n=0;n<o;n++)a=i[n],e.call(null,t[a],a,t)}}function ht(t,e){if(ue(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}const X=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pt=t=>!ne(t)&&t!==X;function Ae(){const{caseless:t,skipUndefined:e}=pt(this)&&this||{},r={},n=(s,i)=>{const o=t&&ht(r,i)||i;ye(r[o])&&ye(s)?r[o]=Ae(r[o],s):ye(s)?r[o]=Ae({},s):se(s)?r[o]=s.slice():(!e||!ne(s))&&(r[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&fe(arguments[s],n);return r}const Qt=(t,e,r,{allOwnKeys:n}={})=>(fe(e,(s,i)=>{r&&j(s)?t[i]=ut(s,r):t[i]=s},{allOwnKeys:n}),t),Yt=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Zt=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},er=(t,e,r,n)=>{let s,i,o;const a={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!n||n(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&Fe(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},tr=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},rr=t=>{if(!t)return null;if(se(t))return t;let e=t.length;if(!dt(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},nr=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Fe(Uint8Array)),sr=(t,e)=>{const n=(t&&t[Se]).call(t);let s;for(;(s=n.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},ir=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},or=z("HTMLFormElement"),ar=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),We=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),cr=z("RegExp"),mt=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};fe(r,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(n[i]=o||s)}),Object.defineProperties(t,n)},ur=t=>{mt(t,(e,r)=>{if(j(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(j(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},lr=(t,e)=>{const r={},n=s=>{s.forEach(i=>{r[i]=!0})};return se(t)?n(t):n(String(t).split(e)),r},fr=()=>{},dr=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function hr(t){return!!(t&&j(t.append)&&t[lt]==="FormData"&&t[Se])}const pr=t=>{const e=new Array(10),r=(n,s)=>{if(le(n)){if(e.indexOf(n)>=0)return;if(ue(n))return n;if(!("toJSON"in n)){e[s]=n;const i=se(n)?[]:{};return fe(n,(o,a)=>{const l=r(o,s+1);!ne(l)&&(i[a]=l)}),e[s]=void 0,i}}return n};return r(t,0)},mr=z("AsyncFunction"),wr=t=>t&&(le(t)||j(t))&&j(t.then)&&j(t.catch),wt=((t,e)=>t?setImmediate:e?((r,n)=>(X.addEventListener("message",({source:s,data:i})=>{s===X&&i===r&&n.length&&n.shift()()},!1),s=>{n.push(s),X.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",j(X.postMessage)),yr=typeof queueMicrotask<"u"?queueMicrotask.bind(X):typeof process<"u"&&process.nextTick||wt,gr=t=>t!=null&&j(t[Se]),c={isArray:se,isArrayBuffer:ft,isBuffer:ue,isFormData:zt,isArrayBufferView:Lt,isString:Bt,isNumber:dt,isBoolean:Ft,isObject:le,isPlainObject:ye,isEmptyObject:jt,isReadableStream:Gt,isRequest:xt,isResponse:Vt,isHeaders:Jt,isUndefined:ne,isDate:Mt,isFile:qt,isBlob:$t,isRegExp:cr,isFunction:j,isStream:Ht,isURLSearchParams:Kt,isTypedArray:nr,isFileList:Wt,forEach:fe,merge:Ae,extend:Qt,trim:Xt,stripBOM:Yt,inherits:Zt,toFlatObject:er,kindOf:Ee,kindOfTest:z,endsWith:tr,toArray:rr,forEachEntry:sr,matchAll:ir,isHTMLForm:or,hasOwnProperty:We,hasOwnProp:We,reduceDescriptors:mt,freezeMethods:ur,toObjectSet:lr,toCamelCase:ar,noop:fr,toFiniteNumber:dr,findKey:ht,global:X,isContextDefined:pt,isSpecCompliantForm:hr,toJSONObject:pr,isAsyncFn:mr,isThenable:wr,setImmediate:wt,asap:yr,isIterable:gr};function k(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}c.inherits(k,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.status}}});const yt=k.prototype,gt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{gt[t]={value:t}});Object.defineProperties(k,gt);Object.defineProperty(yt,"isAxiosError",{value:!0});k.from=(t,e,r,n,s,i)=>{const o=Object.create(yt);c.toFlatObject(t,o,function(f){return f!==Error.prototype},u=>u!=="isAxiosError");const a=t&&t.message?t.message:"Error",l=e==null&&t?t.code:e;return k.call(o,a,l,r,n,s),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",i&&Object.assign(o,i),o};const vr=null;function Ce(t){return c.isPlainObject(t)||c.isArray(t)}function vt(t){return c.endsWith(t,"[]")?t.slice(0,-2):t}function He(t,e,r){return t?t.concat(e).map(function(s,i){return s=vt(s),!r&&i?"["+s+"]":s}).join(r?".":""):e}function br(t){return c.isArray(t)&&!t.some(Ce)}const Sr=c.toFlatObject(c,{},null,function(e){return/^is[A-Z]/.test(e)});function Re(t,e,r){if(!c.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=c.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,y){return!c.isUndefined(y[w])});const n=r.metaTokens,s=r.visitor||f,i=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(e);if(!c.isFunction(s))throw new TypeError("visitor must be a function");function u(d){if(d===null)return"";if(c.isDate(d))return d.toISOString();if(c.isBoolean(d))return d.toString();if(!l&&c.isBlob(d))throw new k("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(d)||c.isTypedArray(d)?l&&typeof Blob=="function"?new Blob([d]):Buffer.from(d):d}function f(d,w,y){let T=d;if(d&&!y&&typeof d=="object"){if(c.endsWith(w,"{}"))w=n?w:w.slice(0,-2),d=JSON.stringify(d);else if(c.isArray(d)&&br(d)||(c.isFileList(d)||c.endsWith(w,"[]"))&&(T=c.toArray(d)))return w=vt(w),T.forEach(function(_,D){!(c.isUndefined(_)||_===null)&&e.append(o===!0?He([w],D,i):o===null?w:w+"[]",u(_))}),!1}return Ce(d)?!0:(e.append(He(y,w,i),u(d)),!1)}const m=[],S=Object.assign(Sr,{defaultVisitor:f,convertValue:u,isVisitable:Ce});function P(d,w){if(!c.isUndefined(d)){if(m.indexOf(d)!==-1)throw Error("Circular reference detected in "+w.join("."));m.push(d),c.forEach(d,function(T,N){(!(c.isUndefined(T)||T===null)&&s.call(e,T,c.isString(N)?N.trim():N,w,S))===!0&&P(T,w?w.concat(N):[N])}),m.pop()}}if(!c.isObject(t))throw new TypeError("data must be an object");return P(t),e}function ze(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function je(t,e){this._pairs=[],t&&Re(t,this,e)}const bt=je.prototype;bt.append=function(e,r){this._pairs.push([e,r])};bt.toString=function(e){const r=e?function(n){return e.call(this,n,ze)}:ze;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function Er(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function St(t,e,r){if(!e)return t;const n=r&&r.encode||Er;c.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let i;if(s?i=s(e,r):i=c.isURLSearchParams(e)?e.toString():new je(e,r).toString(n),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class Ke{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){c.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Et={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},kr=typeof URLSearchParams<"u"?URLSearchParams:je,Rr=typeof FormData<"u"?FormData:null,Ir=typeof Blob<"u"?Blob:null,_r={isBrowser:!0,classes:{URLSearchParams:kr,FormData:Rr,Blob:Ir},protocols:["http","https","file","blob","url","data"]},Me=typeof window<"u"&&typeof document<"u",De=typeof navigator=="object"&&navigator||void 0,Tr=Me&&(!De||["ReactNative","NativeScript","NS"].indexOf(De.product)<0),Pr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Or=Me&&window.location.href||"http://localhost",Ar=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Me,hasStandardBrowserEnv:Tr,hasStandardBrowserWebWorkerEnv:Pr,navigator:De,origin:Or},Symbol.toStringTag,{value:"Module"})),L={...Ar,..._r};function Cr(t,e){return Re(t,new L.classes.URLSearchParams,{visitor:function(r,n,s,i){return L.isNode&&c.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function Dr(t){return c.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Nr(t){const e={},r=Object.keys(t);let n;const s=r.length;let i;for(n=0;n<s;n++)i=r[n],e[i]=t[i];return e}function kt(t){function e(r,n,s,i){let o=r[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=r.length;return o=!o&&c.isArray(s)?s.length:o,l?(c.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!a):((!s[o]||!c.isObject(s[o]))&&(s[o]=[]),e(r,n,s[o],i)&&c.isArray(s[o])&&(s[o]=Nr(s[o])),!a)}if(c.isFormData(t)&&c.isFunction(t.entries)){const r={};return c.forEachEntry(t,(n,s)=>{e(Dr(n),s,r,0)}),r}return null}function Ur(t,e,r){if(c.isString(t))try{return(e||JSON.parse)(t),c.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const de={transitional:Et,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,i=c.isObject(e);if(i&&c.isHTMLForm(e)&&(e=new FormData(e)),c.isFormData(e))return s?JSON.stringify(kt(e)):e;if(c.isArrayBuffer(e)||c.isBuffer(e)||c.isStream(e)||c.isFile(e)||c.isBlob(e)||c.isReadableStream(e))return e;if(c.isArrayBufferView(e))return e.buffer;if(c.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Cr(e,this.formSerializer).toString();if((a=c.isFileList(e))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Re(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(r.setContentType("application/json",!1),Ur(e)):e}],transformResponse:[function(e){const r=this.transitional||de.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(c.isResponse(e)||c.isReadableStream(e))return e;if(e&&c.isString(e)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?k.from(a,k.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:L.classes.FormData,Blob:L.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],t=>{de.headers[t]={}});const Lr=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Br=t=>{const e={};let r,n,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||e[r]&&Lr[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},Ge=Symbol("internals");function ce(t){return t&&String(t).trim().toLowerCase()}function ge(t){return t===!1||t==null?t:c.isArray(t)?t.map(ge):String(t)}function Fr(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const jr=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function _e(t,e,r,n,s){if(c.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!c.isString(e)){if(c.isString(n))return e.indexOf(n)!==-1;if(c.isRegExp(n))return n.test(e)}}function Mr(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function qr(t,e){const r=c.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,i,o){return this[n].call(this,e,s,i,o)},configurable:!0})})}let M=class{constructor(e){e&&this.set(e)}set(e,r,n){const s=this;function i(a,l,u){const f=ce(l);if(!f)throw new Error("header name must be a non-empty string");const m=c.findKey(s,f);(!m||s[m]===void 0||u===!0||u===void 0&&s[m]!==!1)&&(s[m||l]=ge(a))}const o=(a,l)=>c.forEach(a,(u,f)=>i(u,f,l));if(c.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(c.isString(e)&&(e=e.trim())&&!jr(e))o(Br(e),r);else if(c.isObject(e)&&c.isIterable(e)){let a={},l,u;for(const f of e){if(!c.isArray(f))throw TypeError("Object iterator must return a key-value pair");a[u=f[0]]=(l=a[u])?c.isArray(l)?[...l,f[1]]:[l,f[1]]:f[1]}o(a,r)}else e!=null&&i(r,e,n);return this}get(e,r){if(e=ce(e),e){const n=c.findKey(this,e);if(n){const s=this[n];if(!r)return s;if(r===!0)return Fr(s);if(c.isFunction(r))return r.call(this,s,n);if(c.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=ce(e),e){const n=c.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||_e(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let s=!1;function i(o){if(o=ce(o),o){const a=c.findKey(n,o);a&&(!r||_e(n,n[a],a,r))&&(delete n[a],s=!0)}}return c.isArray(e)?e.forEach(i):i(e),s}clear(e){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const i=r[n];(!e||_e(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const r=this,n={};return c.forEach(this,(s,i)=>{const o=c.findKey(n,i);if(o){r[o]=ge(s),delete r[i];return}const a=e?Mr(i):String(i).trim();a!==i&&delete r[i],r[a]=ge(s),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return c.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&c.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[Ge]=this[Ge]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=ce(o);n[a]||(qr(s,o),n[a]=!0)}return c.isArray(e)?e.forEach(i):i(e),this}};M.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(M.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});c.freezeMethods(M);function Te(t,e){const r=this||de,n=e||r,s=M.from(n.headers);let i=n.data;return c.forEach(t,function(a){i=a.call(r,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Rt(t){return!!(t&&t.__CANCEL__)}function ie(t,e,r){k.call(this,t??"canceled",k.ERR_CANCELED,e,r),this.name="CanceledError"}c.inherits(ie,k,{__CANCEL__:!0});function It(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new k("Request failed with status code "+r.status,[k.ERR_BAD_REQUEST,k.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function $r(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Wr(t,e){t=t||10;const r=new Array(t),n=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),f=n[i];o||(o=u),r[s]=l,n[s]=u;let m=i,S=0;for(;m!==s;)S+=r[m++],m=m%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-o<e)return;const P=f&&u-f;return P?Math.round(S*1e3/P):void 0}}function Hr(t,e){let r=0,n=1e3/e,s,i;const o=(u,f=Date.now())=>{r=f,s=null,i&&(clearTimeout(i),i=null),t(...u)};return[(...u)=>{const f=Date.now(),m=f-r;m>=n?o(u,f):(s=u,i||(i=setTimeout(()=>{i=null,o(s)},n-m)))},()=>s&&o(s)]}const be=(t,e,r=3)=>{let n=0;const s=Wr(50,250);return Hr(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-n,u=s(l),f=o<=a;n=o;const m={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&f?(a-o)/u:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(m)},r)},xe=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},Ve=t=>(...e)=>c.asap(()=>t(...e)),zr=L.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,L.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(L.origin),L.navigator&&/(msie|trident)/i.test(L.navigator.userAgent)):()=>!0,Kr=L.hasStandardBrowserEnv?{write(t,e,r,n,s,i){const o=[t+"="+encodeURIComponent(e)];c.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),c.isString(n)&&o.push("path="+n),c.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Gr(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function xr(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function _t(t,e,r){let n=!Gr(e);return t&&(n||r==!1)?xr(t,e):e}const Je=t=>t instanceof M?{...t}:t;function Y(t,e){e=e||{};const r={};function n(u,f,m,S){return c.isPlainObject(u)&&c.isPlainObject(f)?c.merge.call({caseless:S},u,f):c.isPlainObject(f)?c.merge({},f):c.isArray(f)?f.slice():f}function s(u,f,m,S){if(c.isUndefined(f)){if(!c.isUndefined(u))return n(void 0,u,m,S)}else return n(u,f,m,S)}function i(u,f){if(!c.isUndefined(f))return n(void 0,f)}function o(u,f){if(c.isUndefined(f)){if(!c.isUndefined(u))return n(void 0,u)}else return n(void 0,f)}function a(u,f,m){if(m in e)return n(u,f);if(m in t)return n(void 0,u)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,f,m)=>s(Je(u),Je(f),m,!0)};return c.forEach(Object.keys({...t,...e}),function(f){const m=l[f]||s,S=m(t[f],e[f],f);c.isUndefined(S)&&m!==a||(r[f]=S)}),r}const Tt=t=>{const e=Y({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=e;if(e.headers=o=M.from(o),e.url=St(_t(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),c.isFormData(r)){if(L.hasStandardBrowserEnv||L.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(c.isFunction(r.getHeaders)){const l=r.getHeaders(),u=["content-type","content-length"];Object.entries(l).forEach(([f,m])=>{u.includes(f.toLowerCase())&&o.set(f,m)})}}if(L.hasStandardBrowserEnv&&(n&&c.isFunction(n)&&(n=n(e)),n||n!==!1&&zr(e.url))){const l=s&&i&&Kr.read(i);l&&o.set(s,l)}return e},Vr=typeof XMLHttpRequest<"u",Jr=Vr&&function(t){return new Promise(function(r,n){const s=Tt(t);let i=s.data;const o=M.from(s.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=s,f,m,S,P,d;function w(){P&&P(),d&&d(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function T(){if(!y)return;const _=M.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),B={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:_,config:t,request:y};It(function(C){r(C),w()},function(C){n(C),w()},B),y=null}"onloadend"in y?y.onloadend=T:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(T)},y.onabort=function(){y&&(n(new k("Request aborted",k.ECONNABORTED,t,y)),y=null)},y.onerror=function(D){const B=D&&D.message?D.message:"Network Error",$=new k(B,k.ERR_NETWORK,t,y);$.event=D||null,n($),y=null},y.ontimeout=function(){let D=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const B=s.transitional||Et;s.timeoutErrorMessage&&(D=s.timeoutErrorMessage),n(new k(D,B.clarifyTimeoutError?k.ETIMEDOUT:k.ECONNABORTED,t,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&c.forEach(o.toJSON(),function(D,B){y.setRequestHeader(B,D)}),c.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),a&&a!=="json"&&(y.responseType=s.responseType),u&&([S,d]=be(u,!0),y.addEventListener("progress",S)),l&&y.upload&&([m,P]=be(l),y.upload.addEventListener("progress",m),y.upload.addEventListener("loadend",P)),(s.cancelToken||s.signal)&&(f=_=>{y&&(n(!_||_.type?new ie(null,t,y):_),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const N=$r(s.url);if(N&&L.protocols.indexOf(N)===-1){n(new k("Unsupported protocol "+N+":",k.ERR_BAD_REQUEST,t));return}y.send(i||null)})},Xr=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s;const i=function(u){if(!s){s=!0,a();const f=u instanceof Error?u:this.reason;n.abort(f instanceof k?f:new ie(f instanceof Error?f.message:f))}};let o=e&&setTimeout(()=>{o=null,i(new k(`timeout ${e} of ms exceeded`,k.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:l}=n;return l.unsubscribe=()=>c.asap(a),l}},Qr=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},Yr=async function*(t,e){for await(const r of Zr(t))yield*Qr(r,e)},Zr=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},Xe=(t,e,r,n)=>{const s=Yr(t,e);let i=0,o,a=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:f}=await s.next();if(u){a(),l.close();return}let m=f.byteLength;if(r){let S=i+=m;r(S)}l.enqueue(new Uint8Array(f))}catch(u){throw a(u),u}},cancel(l){return a(l),s.return()}},{highWaterMark:2})},Qe=64*1024,{isFunction:pe}=c,en=(({Request:t,Response:e})=>({Request:t,Response:e}))(c.global),{ReadableStream:Ye,TextEncoder:Ze}=c.global,et=(t,...e)=>{try{return!!t(...e)}catch{return!1}},tn=t=>{t=c.merge.call({skipUndefined:!0},en,t);const{fetch:e,Request:r,Response:n}=t,s=e?pe(e):typeof fetch=="function",i=pe(r),o=pe(n);if(!s)return!1;const a=s&&pe(Ye),l=s&&(typeof Ze=="function"?(d=>w=>d.encode(w))(new Ze):async d=>new Uint8Array(await new r(d).arrayBuffer())),u=i&&a&&et(()=>{let d=!1;const w=new r(L.origin,{body:new Ye,method:"POST",get duplex(){return d=!0,"half"}}).headers.has("Content-Type");return d&&!w}),f=o&&a&&et(()=>c.isReadableStream(new n("").body)),m={stream:f&&(d=>d.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(d=>{!m[d]&&(m[d]=(w,y)=>{let T=w&&w[d];if(T)return T.call(w);throw new k(`Response type '${d}' is not supported`,k.ERR_NOT_SUPPORT,y)})});const S=async d=>{if(d==null)return 0;if(c.isBlob(d))return d.size;if(c.isSpecCompliantForm(d))return(await new r(L.origin,{method:"POST",body:d}).arrayBuffer()).byteLength;if(c.isArrayBufferView(d)||c.isArrayBuffer(d))return d.byteLength;if(c.isURLSearchParams(d)&&(d=d+""),c.isString(d))return(await l(d)).byteLength},P=async(d,w)=>{const y=c.toFiniteNumber(d.getContentLength());return y??S(w)};return async d=>{let{url:w,method:y,data:T,signal:N,cancelToken:_,timeout:D,onDownloadProgress:B,onUploadProgress:$,responseType:C,headers:Z,withCredentials:x="same-origin",fetchOptions:he}=Tt(d),oe=e||fetch;C=C?(C+"").toLowerCase():"text";let ee=Xr([N,_&&_.toAbortSignal()],D),V=null;const H=ee&&ee.unsubscribe&&(()=>{ee.unsubscribe()});let te;try{if($&&u&&y!=="get"&&y!=="head"&&(te=await P(Z,T))!==0){let v=new r(w,{method:"POST",body:T,duplex:"half"}),I;if(c.isFormData(T)&&(I=v.headers.get("content-type"))&&Z.setContentType(I),v.body){const[A,U]=xe(te,be(Ve($)));T=Xe(v.body,Qe,A,U)}}c.isString(x)||(x=x?"include":"omit");const q=i&&"credentials"in r.prototype,p={...he,signal:ee,method:y.toUpperCase(),headers:Z.normalize().toJSON(),body:T,duplex:"half",credentials:q?x:void 0};V=i&&new r(w,p);let h=await(i?oe(V,he):oe(w,p));const g=f&&(C==="stream"||C==="response");if(f&&(B||g&&H)){const v={};["status","statusText","headers"].forEach(F=>{v[F]=h[F]});const I=c.toFiniteNumber(h.headers.get("content-length")),[A,U]=B&&xe(I,be(Ve(B),!0))||[];h=new n(Xe(h.body,Qe,A,()=>{U&&U(),H&&H()}),v)}C=C||"text";let E=await m[c.findKey(m,C)||"text"](h,d);return!g&&H&&H(),await new Promise((v,I)=>{It(v,I,{data:E,headers:M.from(h.headers),status:h.status,statusText:h.statusText,config:d,request:V})})}catch(q){throw H&&H(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new k("Network Error",k.ERR_NETWORK,d,V),{cause:q.cause||q}):k.from(q,q&&q.code,d,V)}}},rn=new Map,Pt=t=>{let e=t?t.env:{};const{fetch:r,Request:n,Response:s}=e,i=[n,s,r];let o=i.length,a=o,l,u,f=rn;for(;a--;)l=i[a],u=f.get(l),u===void 0&&f.set(l,u=a?new Map:tn(e)),f=u;return u};Pt();const Ne={http:vr,xhr:Jr,fetch:{get:Pt}};c.forEach(Ne,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const tt=t=>`- ${t}`,nn=t=>c.isFunction(t)||t===null||t===!1,Ot={getAdapter:(t,e)=>{t=c.isArray(t)?t:[t];const{length:r}=t;let n,s;const i={};for(let o=0;o<r;o++){n=t[o];let a;if(s=n,!nn(n)&&(s=Ne[(a=String(n)).toLowerCase()],s===void 0))throw new k(`Unknown adapter '${a}'`);if(s&&(c.isFunction(s)||(s=s.get(e))))break;i[a||"#"+o]=s}if(!s){const o=Object.entries(i).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=r?o.length>1?`since :
`+o.map(tt).join(`
`):" "+tt(o[0]):"as no adapter specified";throw new k("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return s},adapters:Ne};function Pe(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ie(null,t)}function rt(t){return Pe(t),t.headers=M.from(t.headers),t.data=Te.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Ot.getAdapter(t.adapter||de.adapter,t)(t).then(function(n){return Pe(t),n.data=Te.call(t,t.transformResponse,n),n.headers=M.from(n.headers),n},function(n){return Rt(n)||(Pe(t),n&&n.response&&(n.response.data=Te.call(t,t.transformResponse,n.response),n.response.headers=M.from(n.response.headers))),Promise.reject(n)})}const At="1.12.2",Ie={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Ie[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const nt={};Ie.transitional=function(e,r,n){function s(i,o){return"[Axios v"+At+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,a)=>{if(e===!1)throw new k(s(o," has been removed"+(r?" in "+r:"")),k.ERR_DEPRECATED);return r&&!nt[o]&&(nt[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(i,o,a):!0}};Ie.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function sn(t,e,r){if(typeof t!="object")throw new k("options must be an object",k.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const i=n[s],o=e[i];if(o){const a=t[i],l=a===void 0||o(a,i,t);if(l!==!0)throw new k("option "+i+" must be "+l,k.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new k("Unknown option "+i,k.ERR_BAD_OPTION)}}const ve={assertOptions:sn,validators:Ie},K=ve.validators;let Q=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Ke,response:new Ke}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Y(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:i}=r;n!==void 0&&ve.assertOptions(n,{silentJSONParsing:K.transitional(K.boolean),forcedJSONParsing:K.transitional(K.boolean),clarifyTimeoutError:K.transitional(K.boolean)},!1),s!=null&&(c.isFunction(s)?r.paramsSerializer={serialize:s}:ve.assertOptions(s,{encode:K.function,serialize:K.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ve.assertOptions(r,{baseUrl:K.spelling("baseURL"),withXsrfToken:K.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&c.merge(i.common,i[r.method]);i&&c.forEach(["delete","get","head","post","put","patch","common"],d=>{delete i[d]}),r.headers=M.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(r)===!1||(l=l&&w.synchronous,a.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let f,m=0,S;if(!l){const d=[rt.bind(this),void 0];for(d.unshift(...a),d.push(...u),S=d.length,f=Promise.resolve(r);m<S;)f=f.then(d[m++],d[m++]);return f}S=a.length;let P=r;for(;m<S;){const d=a[m++],w=a[m++];try{P=d(P)}catch(y){w.call(this,y);break}}try{f=rt.call(this,P)}catch(d){return Promise.reject(d)}for(m=0,S=u.length;m<S;)f=f.then(u[m++],u[m++]);return f}getUri(e){e=Y(this.defaults,e);const r=_t(e.baseURL,e.url,e.allowAbsoluteUrls);return St(r,e.params,e.paramsSerializer)}};c.forEach(["delete","get","head","options"],function(e){Q.prototype[e]=function(r,n){return this.request(Y(n||{},{method:e,url:r,data:(n||{}).data}))}});c.forEach(["post","put","patch"],function(e){function r(n){return function(i,o,a){return this.request(Y(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Q.prototype[e]=r(),Q.prototype[e+"Form"]=r(!0)});let on=class Ct{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(s=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](s);n._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{n.subscribe(a),i=a}).then(s);return o.cancel=function(){n.unsubscribe(i)},o},e(function(i,o,a){n.reason||(n.reason=new ie(i,o,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Ct(function(s){e=s}),cancel:e}}};function an(t){return function(r){return t.apply(null,r)}}function cn(t){return c.isObject(t)&&t.isAxiosError===!0}const Ue={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ue).forEach(([t,e])=>{Ue[e]=t});function Dt(t){const e=new Q(t),r=ut(Q.prototype.request,e);return c.extend(r,Q.prototype,e,{allOwnKeys:!0}),c.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return Dt(Y(t,s))},r}const O=Dt(de);O.Axios=Q;O.CanceledError=ie;O.CancelToken=on;O.isCancel=Rt;O.VERSION=At;O.toFormData=Re;O.AxiosError=k;O.Cancel=O.CanceledError;O.all=function(e){return Promise.all(e)};O.spread=an;O.isAxiosError=cn;O.mergeConfig=Y;O.AxiosHeaders=M;O.formToJSON=t=>kt(c.isHTMLForm(t)?new FormData(t):t);O.getAdapter=Ot.getAdapter;O.HttpStatusCode=Ue;O.default=O;const{Axios:jn,AxiosError:Mn,CanceledError:qn,isCancel:$n,CancelToken:Wn,VERSION:Hn,all:zn,Cancel:Kn,isAxiosError:Gn,spread:xn,toFormData:Vn,AxiosHeaders:Jn,HttpStatusCode:Xn,formToJSON:Qn,getAdapter:Yn,mergeConfig:Zn}=O;window.axios=O;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";function un(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}var ln=un;function fn(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}var dn=fn;function hn(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var pn=hn;function mn(t){return ln(t)||dn(t)||pn()}var wn=mn;function yn(t,e){return e={exports:{}},t(e,e.exports),e.exports}var gn=yn(function(t){var e=(function(r){var n=Object.prototype,s=n.hasOwnProperty,i,o=typeof Symbol=="function"?Symbol:{},a=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function f(p,h,g,E){var v=h&&h.prototype instanceof T?h:T,I=Object.create(v.prototype),A=new H(E||[]);return I._invoke=he(p,g,A),I}r.wrap=f;function m(p,h,g){try{return{type:"normal",arg:p.call(h,g)}}catch(E){return{type:"throw",arg:E}}}var S="suspendedStart",P="suspendedYield",d="executing",w="completed",y={};function T(){}function N(){}function _(){}var D={};D[a]=function(){return this};var B=Object.getPrototypeOf,$=B&&B(B(te([])));$&&$!==n&&s.call($,a)&&(D=$);var C=_.prototype=T.prototype=Object.create(D);N.prototype=C.constructor=_,_.constructor=N,_[u]=N.displayName="GeneratorFunction";function Z(p){["next","throw","return"].forEach(function(h){p[h]=function(g){return this._invoke(h,g)}})}r.isGeneratorFunction=function(p){var h=typeof p=="function"&&p.constructor;return h?h===N||(h.displayName||h.name)==="GeneratorFunction":!1},r.mark=function(p){return Object.setPrototypeOf?Object.setPrototypeOf(p,_):(p.__proto__=_,u in p||(p[u]="GeneratorFunction")),p.prototype=Object.create(C),p},r.awrap=function(p){return{__await:p}};function x(p){function h(v,I,A,U){var F=m(p[v],p,I);if(F.type==="throw")U(F.arg);else{var W=F.arg,ae=W.value;return ae&&typeof ae=="object"&&s.call(ae,"__await")?Promise.resolve(ae.__await).then(function(J){h("next",J,A,U)},function(J){h("throw",J,A,U)}):Promise.resolve(ae).then(function(J){W.value=J,A(W)},function(J){return h("throw",J,A,U)})}}var g;function E(v,I){function A(){return new Promise(function(U,F){h(v,I,U,F)})}return g=g?g.then(A,A):A()}this._invoke=E}Z(x.prototype),x.prototype[l]=function(){return this},r.AsyncIterator=x,r.async=function(p,h,g,E){var v=new x(f(p,h,g,E));return r.isGeneratorFunction(h)?v:v.next().then(function(I){return I.done?I.value:v.next()})};function he(p,h,g){var E=S;return function(I,A){if(E===d)throw new Error("Generator is already running");if(E===w){if(I==="throw")throw A;return q()}for(g.method=I,g.arg=A;;){var U=g.delegate;if(U){var F=oe(U,g);if(F){if(F===y)continue;return F}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(E===S)throw E=w,g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);E=d;var W=m(p,h,g);if(W.type==="normal"){if(E=g.done?w:P,W.arg===y)continue;return{value:W.arg,done:g.done}}else W.type==="throw"&&(E=w,g.method="throw",g.arg=W.arg)}}}function oe(p,h){var g=p.iterator[h.method];if(g===i){if(h.delegate=null,h.method==="throw"){if(p.iterator.return&&(h.method="return",h.arg=i,oe(p,h),h.method==="throw"))return y;h.method="throw",h.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var E=m(g,p.iterator,h.arg);if(E.type==="throw")return h.method="throw",h.arg=E.arg,h.delegate=null,y;var v=E.arg;if(!v)return h.method="throw",h.arg=new TypeError("iterator result is not an object"),h.delegate=null,y;if(v.done)h[p.resultName]=v.value,h.next=p.nextLoc,h.method!=="return"&&(h.method="next",h.arg=i);else return v;return h.delegate=null,y}Z(C),C[u]="Generator",C[a]=function(){return this},C.toString=function(){return"[object Generator]"};function ee(p){var h={tryLoc:p[0]};1 in p&&(h.catchLoc=p[1]),2 in p&&(h.finallyLoc=p[2],h.afterLoc=p[3]),this.tryEntries.push(h)}function V(p){var h=p.completion||{};h.type="normal",delete h.arg,p.completion=h}function H(p){this.tryEntries=[{tryLoc:"root"}],p.forEach(ee,this),this.reset(!0)}r.keys=function(p){var h=[];for(var g in p)h.push(g);return h.reverse(),function E(){for(;h.length;){var v=h.pop();if(v in p)return E.value=v,E.done=!1,E}return E.done=!0,E}};function te(p){if(p){var h=p[a];if(h)return h.call(p);if(typeof p.next=="function")return p;if(!isNaN(p.length)){var g=-1,E=function v(){for(;++g<p.length;)if(s.call(p,g))return v.value=p[g],v.done=!1,v;return v.value=i,v.done=!0,v};return E.next=E}}return{next:q}}r.values=te;function q(){return{value:i,done:!0}}return H.prototype={constructor:H,reset:function(p){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(V),!p)for(var h in this)h.charAt(0)==="t"&&s.call(this,h)&&!isNaN(+h.slice(1))&&(this[h]=i)},stop:function(){this.done=!0;var p=this.tryEntries[0],h=p.completion;if(h.type==="throw")throw h.arg;return this.rval},dispatchException:function(p){if(this.done)throw p;var h=this;function g(F,W){return I.type="throw",I.arg=p,h.next=F,W&&(h.method="next",h.arg=i),!!W}for(var E=this.tryEntries.length-1;E>=0;--E){var v=this.tryEntries[E],I=v.completion;if(v.tryLoc==="root")return g("end");if(v.tryLoc<=this.prev){var A=s.call(v,"catchLoc"),U=s.call(v,"finallyLoc");if(A&&U){if(this.prev<v.catchLoc)return g(v.catchLoc,!0);if(this.prev<v.finallyLoc)return g(v.finallyLoc)}else if(A){if(this.prev<v.catchLoc)return g(v.catchLoc,!0)}else if(U){if(this.prev<v.finallyLoc)return g(v.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(p,h){for(var g=this.tryEntries.length-1;g>=0;--g){var E=this.tryEntries[g];if(E.tryLoc<=this.prev&&s.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var v=E;break}}v&&(p==="break"||p==="continue")&&v.tryLoc<=h&&h<=v.finallyLoc&&(v=null);var I=v?v.completion:{};return I.type=p,I.arg=h,v?(this.method="next",this.next=v.finallyLoc,y):this.complete(I)},complete:function(p,h){if(p.type==="throw")throw p.arg;return p.type==="break"||p.type==="continue"?this.next=p.arg:p.type==="return"?(this.rval=this.arg=p.arg,this.method="return",this.next="end"):p.type==="normal"&&h&&(this.next=h),y},finish:function(p){for(var h=this.tryEntries.length-1;h>=0;--h){var g=this.tryEntries[h];if(g.finallyLoc===p)return this.complete(g.completion,g.afterLoc),V(g),y}},catch:function(p){for(var h=this.tryEntries.length-1;h>=0;--h){var g=this.tryEntries[h];if(g.tryLoc===p){var E=g.completion;if(E.type==="throw"){var v=E.arg;V(g)}return v}}throw new Error("illegal catch attempt")},delegateYield:function(p,h,g){return this.delegate={iterator:te(p),resultName:h,nextLoc:g},this.method==="next"&&(this.arg=i),y}},r})(t.exports);try{regeneratorRuntime=e}catch{Function("r","regeneratorRuntime = r")(e)}}),b=gn;function st(t,e,r,n,s,i,o){try{var a=t[i](o),l=a.value}catch(u){r(u);return}a.done?e(l):Promise.resolve(l).then(n,s)}function vn(t){return function(){var e=this,r=arguments;return new Promise(function(n,s){var i=t.apply(e,r);function o(l){st(i,n,s,o,a,"next",l)}function a(l){st(i,n,s,o,a,"throw",l)}o(void 0)})}}var R=vn;function bn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var qe=bn;function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sn(t,e,r){return e&&it(t.prototype,e),r&&it(t,r),t}var $e=Sn;function En(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kn=En;function Rn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable}))),n.forEach(function(s){kn(t,s,r[s])})}return t}var Nt=Rn;function G(t){var e=t.method,r=t.path,n=t.body,s=n===void 0?null:n,i=t.headers,o=i===void 0?{}:i,a=t.credentials,l=a===void 0?"same-origin":a,u={method:e,headers:o,credentials:l};return s!==null&&(u.body=JSON.stringify(s),u.headers=Nt({"Content-Type":"application/json"},o)),fetch(r,u).then((function(){var f=R(b.mark(function m(S){return b.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(S.ok){d.next=3;break}return d.next=3,In(S);case 3:return d.prev=3,d.next=6,S.json();case 6:return d.abrupt("return",d.sent);case 9:return d.prev=9,d.t0=d.catch(3),d.abrupt("return",null);case 12:case"end":return d.stop()}},m,null,[[3,9]])}));return function(m){return f.apply(this,arguments)}})())}function In(t){return Le.apply(this,arguments)}function Le(){return Le=R(b.mark(function t(e){var r,n,s,i,o,a;return b.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,e.json();case 3:n=u.sent,s=n.error,i=s===void 0?"Unknown error":s,o=n.description,a=o===void 0?"No description":o,r="Unexpected status code ".concat(e.status,": ").concat(i,", ").concat(a),u.next=14;break;case 11:u.prev=11,u.t0=u.catch(0),r="Unexpected status code ".concat(e.status,": Cannot parse error response");case 14:throw new Error(r);case 15:case"end":return u.stop()}},t,null,[[0,11]])})),Le.apply(this,arguments)}var _n=(function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.url,n=e.queryParams,s=e.headers,i=e.credentials;qe(this,t),this.url=r,this.queryParams=n,this.headers=s,this.credentials=i}return $e(t,[{key:"fetchToken",value:(function(){var e=R(b.mark(function n(s){var i,o,a,l;return b.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i=Nt({user_id:s},this.queryParams),o=Object.entries(i).map(function(m){return m.map(encodeURIComponent).join("=")}).join("&"),a={method:"GET",path:"".concat(this.url,"?").concat(o),headers:this.headers,credentials:this.credentials},f.next=5,G(a);case 5:return l=f.sent,f.abrupt("return",l);case 7:case"end":return f.stop()}},n,this)}));function r(n){return e.apply(this,arguments)}return r})()}]),t})(),Tn=(function(){function t(e){qe(this,t),this._instanceId=e,this._dbConn=null}return $e(t,[{key:"connect",value:function(){var r=this;return new Promise(function(n,s){var i=indexedDB.open(r._dbName);i.onsuccess=function(o){var a=o.target.result;r._dbConn=a,r._readState().then(function(l){return l===null?r.clear():Promise.resolve()}).then(n)},i.onupgradeneeded=function(o){var a=o.target.result;a.createObjectStore("beams",{keyPath:"instance_id"})},i.onerror=function(o){var a=new Error("Database error: ".concat(o.target.error));s(a)}})}},{key:"clear",value:function(){return this._writeState({instance_id:this._instanceId,device_id:null,token:null,user_id:null})}},{key:"_readState",value:function(){var r=this;if(!this.isConnected)throw new Error("Cannot read value: DeviceStateStore not connected to IndexedDB");return new Promise(function(n,s){var i=r._dbConn.transaction("beams").objectStore("beams").get(r._instanceId);i.onsuccess=function(o){var a=o.target.result;a||n(null),n(a)},i.onerror=function(o){s(o.target.error)}})}},{key:"_readProperty",value:(function(){var e=R(b.mark(function n(s){var i;return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._readState();case 2:if(i=a.sent,i!==null){a.next=5;break}return a.abrupt("return",null);case 5:return a.abrupt("return",i[s]||null);case 6:case"end":return a.stop()}},n,this)}));function r(n){return e.apply(this,arguments)}return r})()},{key:"_writeState",value:function(r){var n=this;if(!this.isConnected)throw new Error("Cannot write value: DeviceStateStore not connected to IndexedDB");return new Promise(function(s,i){var o=n._dbConn.transaction("beams","readwrite").objectStore("beams").put(r);o.onsuccess=function(a){s()},o.onerror=function(a){i(a.target.error)}})}},{key:"_writeProperty",value:(function(){var e=R(b.mark(function n(s,i){var o;return b.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._readState();case 2:return o=l.sent,o[s]=i,l.next=6,this._writeState(o);case 6:case"end":return l.stop()}},n,this)}));function r(n,s){return e.apply(this,arguments)}return r})()},{key:"getToken",value:function(){return this._readProperty("token")}},{key:"setToken",value:function(r){return this._writeProperty("token",r)}},{key:"getDeviceId",value:function(){return this._readProperty("device_id")}},{key:"setDeviceId",value:function(r){return this._writeProperty("device_id",r)}},{key:"getUserId",value:function(){return this._readProperty("user_id")}},{key:"setUserId",value:function(r){return this._writeProperty("user_id",r)}},{key:"getLastSeenSdkVersion",value:function(){return this._readProperty("last_seen_sdk_version")}},{key:"setLastSeenSdkVersion",value:function(r){return this._writeProperty("last_seen_sdk_version",r)}},{key:"getLastSeenUserAgent",value:function(){return this._readProperty("last_seen_user_agent")}},{key:"setLastSeenUserAgent",value:function(r){return this._writeProperty("last_seen_user_agent",r)}},{key:"_dbName",get:function(){return"beams-".concat(this._instanceId)}},{key:"isConnected",get:function(){return this._dbConn!==null}}]),t})(),re="1.1.0",Pn=new RegExp("^(_|\\-|=|@|,|\\.|;|[A-Z]|[a-z]|[0-9])*$"),ot=164,at=5e3,ct="/service-worker.js?pusherBeamsWebSDKVersion=".concat(re),me=Object.freeze({PERMISSION_PROMPT_REQUIRED:"PERMISSION_PROMPT_REQUIRED",PERMISSION_GRANTED_NOT_REGISTERED_WITH_BEAMS:"PERMISSION_GRANTED_NOT_REGISTERED_WITH_BEAMS",PERMISSION_GRANTED_REGISTERED_WITH_BEAMS:"PERMISSION_GRANTED_REGISTERED_WITH_BEAMS",PERMISSION_DENIED:"PERMISSION_DENIED"}),On=(function(){function t(e){if(qe(this,t),!e)throw new Error("Config object required");var r=e.instanceId,n=e.endpointOverride,s=n===void 0?null:n,i=e.serviceWorkerRegistration,o=i===void 0?null:i;if(r===void 0)throw new Error("Instance ID is required");if(typeof r!="string")throw new Error("Instance ID must be a string");if(r.length===0)throw new Error("Instance ID cannot be empty");if(!("indexedDB"in window))throw new Error("Pusher Beams does not support this browser version (IndexedDB not supported)");if(!window.isSecureContext)throw new Error("Pusher Beams relies on Service Workers, which only work in secure contexts. Check that your page is being served from localhost/over HTTPS");if(!("serviceWorker"in navigator))throw new Error("Pusher Beams does not support this browser version (Service Workers not supported)");if(!("PushManager"in window))throw new Error("Pusher Beams does not support this browser version (Web Push not supported)");if(o){var a=o.scope,l=window.location.href,u=l.startsWith(a);if(!u)throw new Error("Could not initialize Pusher web push: current page not in serviceWorkerRegistration scope (".concat(a,")"))}this.instanceId=r,this._deviceId=null,this._token=null,this._userId=null,this._serviceWorkerRegistration=o,this._deviceStateStore=new Tn(r),this._endpoint=s,this._ready=this._init()}return $e(t,[{key:"_init",value:(function(){var e=R(b.mark(function n(){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this._deviceId===null){i.next=2;break}return i.abrupt("return");case 2:return i.next=4,this._deviceStateStore.connect();case 4:if(!this._serviceWorkerRegistration){i.next=9;break}return i.next=7,window.navigator.serviceWorker.ready;case 7:i.next=12;break;case 9:return i.next=11,An();case 11:this._serviceWorkerRegistration=i.sent;case 12:return i.next=14,this._detectSubscriptionChange();case 14:return i.next=16,this._deviceStateStore.getDeviceId();case 16:return this._deviceId=i.sent,i.next=19,this._deviceStateStore.getToken();case 19:return this._token=i.sent,i.next=22,this._deviceStateStore.getUserId();case 22:this._userId=i.sent;case 23:case"end":return i.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_resolveSDKState",value:(function(){var e=R(b.mark(function n(){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._ready;case 2:return i.next=4,this._detectSubscriptionChange();case 4:case"end":return i.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_detectSubscriptionChange",value:(function(){var e=R(b.mark(function n(){var s,i,o;return b.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._deviceStateStore.getToken();case 2:return s=l.sent,l.next=5,Cn(this._serviceWorkerRegistration);case 5:if(i=l.sent,o=s!==i,!o){l.next=13;break}return l.next=10,this._deviceStateStore.clear();case 10:this._deviceId=null,this._token=null,this._userId=null;case 13:case"end":return l.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"getDeviceId",value:(function(){var e=R(b.mark(function n(){var s=this;return b.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this._resolveSDKState();case 2:return o.abrupt("return",this._ready.then(function(){return s._deviceId}));case 3:case"end":return o.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"getToken",value:(function(){var e=R(b.mark(function n(){var s=this;return b.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this._resolveSDKState();case 2:return o.abrupt("return",this._ready.then(function(){return s._token}));case 3:case"end":return o.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"getUserId",value:(function(){var e=R(b.mark(function n(){var s=this;return b.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this._resolveSDKState();case 2:return o.abrupt("return",this._ready.then(function(){return s._userId}));case 3:case"end":return o.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_throwIfNotStarted",value:function(r){if(!this._deviceId)throw new Error("".concat(r,". SDK not registered with Beams. Did you call .start?"))}},{key:"start",value:(function(){var e=R(b.mark(function n(){var s,i,o,a;return b.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this._resolveSDKState();case 2:if(we()){u.next=4;break}return u.abrupt("return",this);case 4:if(this._deviceId===null){u.next=6;break}return u.abrupt("return",this);case 6:return u.next=8,this._getPublicKey();case 8:return s=u.sent,i=s.vapidPublicKey,u.next=12,this._getPushToken(i);case 12:return o=u.sent,u.next=15,this._registerDevice(o);case 15:return a=u.sent,u.next=18,this._deviceStateStore.setToken(o);case 18:return u.next=20,this._deviceStateStore.setDeviceId(a);case 20:return u.next=22,this._deviceStateStore.setLastSeenSdkVersion(re);case 22:return u.next=24,this._deviceStateStore.setLastSeenUserAgent(window.navigator.userAgent);case 24:return this._token=o,this._deviceId=a,u.abrupt("return",this);case 27:case"end":return u.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"getRegistrationState",value:(function(){var e=R(b.mark(function n(){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._resolveSDKState();case 2:if(Notification.permission!=="denied"){i.next=4;break}return i.abrupt("return",me.PERMISSION_DENIED);case 4:if(!(Notification.permission==="granted"&&this._deviceId!==null)){i.next=6;break}return i.abrupt("return",me.PERMISSION_GRANTED_REGISTERED_WITH_BEAMS);case 6:if(!(Notification.permission==="granted"&&this._deviceId===null)){i.next=8;break}return i.abrupt("return",me.PERMISSION_GRANTED_NOT_REGISTERED_WITH_BEAMS);case 8:return i.abrupt("return",me.PERMISSION_PROMPT_REQUIRED);case 9:case"end":return i.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"addDeviceInterest",value:(function(){var e=R(b.mark(function n(s){var i,o;return b.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not add Device Interest"),Oe(s),i="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests/").concat(encodeURIComponent(s)),o={method:"POST",path:i},l.next=8,G(o);case 8:case"end":return l.stop()}},n,this)}));function r(n){return e.apply(this,arguments)}return r})()},{key:"removeDeviceInterest",value:(function(){var e=R(b.mark(function n(s){var i,o;return b.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not remove Device Interest"),Oe(s),i="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests/").concat(encodeURIComponent(s)),o={method:"DELETE",path:i},l.next=8,G(o);case 8:case"end":return l.stop()}},n,this)}));function r(n){return e.apply(this,arguments)}return r})()},{key:"getDeviceInterests",value:(function(){var e=R(b.mark(function n(){var s,i;return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not get Device Interests"),s="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests"),i={method:"GET",path:s},a.next=7,G(i);case 7:if(a.t0=a.sent.interests,a.t0){a.next=10;break}a.t0=[];case 10:return a.abrupt("return",a.t0);case 11:case"end":return a.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"setDeviceInterests",value:(function(){var e=R(b.mark(function n(s){var i,o,a,l,u,f,m,S,P;return b.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._resolveSDKState();case 2:if(this._throwIfNotStarted("Could not set Device Interests"),s!=null){w.next=5;break}throw new Error("interests argument is required");case 5:if(Array.isArray(s)){w.next=7;break}throw new Error("interests argument must be an array");case 7:if(!(s.length>at)){w.next=9;break}throw new Error("Number of interests (".concat(s.length,") exceeds maximum of ").concat(at));case 9:for(i=!0,o=!1,a=void 0,w.prev=12,l=s[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)f=u.value,Oe(f);w.next=20;break;case 16:w.prev=16,w.t0=w.catch(12),o=!0,a=w.t0;case 20:w.prev=20,w.prev=21,!i&&l.return!=null&&l.return();case 23:if(w.prev=23,!o){w.next=26;break}throw a;case 26:return w.finish(23);case 27:return w.finish(20);case 28:return m=Array.from(new Set(s)),S="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests"),P={method:"PUT",path:S,body:{interests:m}},w.next=33,G(P);case 33:case"end":return w.stop()}},n,this,[[12,16,20,28],[21,,23,27]])}));function r(n){return e.apply(this,arguments)}return r})()},{key:"clearDeviceInterests",value:(function(){var e=R(b.mark(function n(){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not clear Device Interests"),i.next=5,this.setDeviceInterests([]);case 5:case"end":return i.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"setUserId",value:(function(){var e=R(b.mark(function n(s,i){var o,a,l,u,f;return b.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._resolveSDKState();case 2:if(we()){S.next=4;break}return S.abrupt("return");case 4:if(this._deviceId!==null){S.next=7;break}return o=new Error(".start must be called before .setUserId"),S.abrupt("return",Promise.reject(o));case 7:if(typeof s=="string"){S.next=9;break}throw new Error("User ID must be a string (was ".concat(s,")"));case 9:if(s!==""){S.next=11;break}throw new Error("User ID cannot be the empty string");case 11:if(!(this._userId!==null&&this._userId!==s)){S.next=13;break}throw new Error("Changing the `userId` is not allowed.");case 13:return a="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/user"),S.next=16,i.fetchToken(s);case 16:return l=S.sent,u=l.token,f={method:"PUT",path:a,headers:{Authorization:"Bearer ".concat(u)}},S.next=21,G(f);case 21:return this._userId=s,S.abrupt("return",this._deviceStateStore.setUserId(s));case 23:case"end":return S.stop()}},n,this)}));function r(n,s){return e.apply(this,arguments)}return r})()},{key:"stop",value:(function(){var e=R(b.mark(function n(){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._resolveSDKState();case 2:if(we()){i.next=4;break}return i.abrupt("return");case 4:if(this._deviceId!==null){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,this._deleteDevice();case 8:return i.next=10,this._deviceStateStore.clear();case 10:this._clearPushToken().catch(function(){}),this._deviceId=null,this._token=null,this._userId=null;case 14:case"end":return i.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"clearAllState",value:(function(){var e=R(b.mark(function n(){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(we()){i.next=2;break}return i.abrupt("return");case 2:return i.next=4,this.stop();case 4:return i.next=6,this.start();case 6:case"end":return i.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_getPublicKey",value:(function(){var e=R(b.mark(function n(){var s,i;return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/web-vapid-public-key"),i={method:"GET",path:s},a.abrupt("return",G(i));case 3:case"end":return a.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_getPushToken",value:(function(){var e=R(b.mark(function n(s){var i;return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this._clearPushToken();case 3:return a.next=5,this._serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Nn(s)});case 5:return i=a.sent,a.abrupt("return",btoa(JSON.stringify(i)));case 9:return a.prev=9,a.t0=a.catch(0),a.abrupt("return",Promise.reject(a.t0));case 12:case"end":return a.stop()}},n,this,[[0,9]])}));function r(n){return e.apply(this,arguments)}return r})()},{key:"_clearPushToken",value:(function(){var e=R(b.mark(function n(){return b.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",navigator.serviceWorker.ready.then(function(o){return o.pushManager.getSubscription()}).then(function(o){o&&o.unsubscribe()}));case 1:case"end":return i.stop()}},n)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_registerDevice",value:(function(){var e=R(b.mark(function n(s){var i,o,a,l;return b.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web"),o={token:s,metadata:{sdkVersion:re}},a={method:"POST",path:i,body:o},f.next=5,G(a);case 5:return l=f.sent,f.abrupt("return",l.id);case 7:case"end":return f.stop()}},n,this)}));function r(n){return e.apply(this,arguments)}return r})()},{key:"_deleteDevice",value:(function(){var e=R(b.mark(function n(){var s,i;return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(encodeURIComponent(this._deviceId)),i={method:"DELETE",path:s},a.next=4,G(i);case 4:case"end":return a.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_updateDeviceMetadata",value:(function(){var e=R(b.mark(function n(){var s,i,o,a,l,u;return b.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return s=window.navigator.userAgent,m.next=3,this._deviceStateStore.getLastSeenUserAgent();case 3:return i=m.sent,m.next=6,this._deviceStateStore.getLastSeenSdkVersion();case 6:if(o=m.sent,!(s===i&&re===o)){m.next=9;break}return m.abrupt("return");case 9:return a="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/metadata"),l={sdkVersion:re},u={method:"PUT",path:a,body:l},m.next=14,G(u);case 14:return m.next=16,this._deviceStateStore.setLastSeenSdkVersion(re);case 16:return m.next=18,this._deviceStateStore.setLastSeenUserAgent(s);case 18:case"end":return m.stop()}},n,this)}));function r(){return e.apply(this,arguments)}return r})()},{key:"_baseURL",get:function(){return this._endpoint!==null?this._endpoint:"https://".concat(this.instanceId,".pushnotifications.pusher.com")}}]),t})(),Oe=function(e){if(e==null)throw new Error("Interest name is required");if(typeof e!="string")throw new Error("Interest ".concat(e," is not a string"));if(!Pn.test(e))throw new Error('interest "'.concat(e,'" contains a forbidden character. ')+"Allowed characters are: ASCII upper/lower-case letters, numbers or one of _-=@,.;");if(e.length>ot)throw new Error("Interest is longer than the maximum of ".concat(ot," chars"))};function An(){return Be.apply(this,arguments)}function Be(){return Be=R(b.mark(function t(){var e,r;return b.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,fetch(ct);case 2:if(e=s.sent,r=e.status,r===200){s.next=6;break}throw new Error("Cannot start SDK, service worker missing: No file found at /service-worker.js");case 6:return window.navigator.serviceWorker.register(ct,{updateViaCache:"none"}),s.abrupt("return",window.navigator.serviceWorker.ready);case 8:case"end":return s.stop()}},t)})),Be.apply(this,arguments)}function Cn(t){return t.pushManager.getSubscription().then(function(e){return e?Dn(e):null})}function Dn(t){return btoa(JSON.stringify(t))}function Nn(t){var e="=".repeat((4-t.length%4)%4),r=(t+e).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(r);return Uint8Array.from(wn(n).map(function(s){return s.charCodeAt(0)}))}function we(){var t=window.navigator,e=t.vendor,r=window.chrome!==null&&typeof window.chrome<"u",n=t.userAgent.indexOf("OPR")>-1,s=t.userAgent.indexOf("Edg")>-1,i=t.userAgent.indexOf("Firefox")>-1,o=r&&e==="Google Inc."&&!s&&!n,a=o||n||i||s;return a||console.warn("Pusher Web Push Notifications supports Chrome, Firefox, Edge and Opera."),a}class Un{constructor(){this.beamsClient=null,this.isInitialized=!1,this.initPromise=null,this.init()}async init(){return this.initPromise?this.initPromise:(this.initPromise=this._doInit(),this.initPromise)}async _doInit(){if("serviceWorker"in navigator&&"PushManager"in window)try{const e=await this.registerServiceWorker();await this.initializePusherBeams(e),this.isInitialized=!0,console.log("Notification manager initialized successfully")}catch(e){throw console.error("Failed to initialize notifications:",e),e}else throw new Error("Push notifications are not supported in this browser")}async registerServiceWorker(){const e=await navigator.serviceWorker.getRegistrations();for(let n of e)await n.unregister();const r=await navigator.serviceWorker.register("/service-worker.js?v="+Date.now());return console.log("Service Worker registered:",r),await navigator.serviceWorker.ready,console.log("Service Worker is ready"),r}async initializePusherBeams(e){if(!window.pusherBeamsInstanceId)throw new Error("Pusher Beams instance ID not found. Please check your configuration.");console.log("Initializing Pusher Beams with instance ID:",window.pusherBeamsInstanceId),this.beamsClient=new On({instanceId:window.pusherBeamsInstanceId,serviceWorkerRegistration:e}),console.log("Pusher Beams initialized successfully")}async requestPermission(){if(!("Notification"in window))throw new Error("This browser does not support notifications");if(Notification.permission==="granted")return!0;if(Notification.permission==="denied")throw new Error("Notifications are blocked");return await Notification.requestPermission()==="granted"}async subscribe(e){try{if(await this.init(),!this.isInitialized||!this.beamsClient)throw new Error("Notification manager failed to initialize");if(!await this.requestPermission())throw new Error("Notification permission denied");console.log("Starting Pusher Beams client..."),await this.beamsClient.start(),console.log("Pusher Beams client started successfully"),console.log("Setting user ID:",e);const n=document.querySelector('meta[name="csrf-token"]'),s=n?n.getAttribute("content"):null;console.log("CSRF Token Element:",n),console.log("CSRF Token Value:",s);const i=new _n({url:"/api/pusher/beams-auth",queryParams:{user_id:e},headers:{"X-CSRF-TOKEN":s,Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin"});console.log("Created TokenProvider");try{await this.beamsClient.setUserId(e.toString(),i),console.log("User ID set successfully with TokenProvider"),await this.storeSubscriptionLocally(e)}catch(o){throw console.error("SetUserId failed:",o),o}return console.log("Successfully subscribed to push notifications"),!0}catch(r){throw console.error("Failed to subscribe to notifications:",r),r}}async unsubscribe(){if(this.beamsClient)try{await this.beamsClient.stop(),console.log("Successfully unsubscribed from push notifications")}catch(e){throw console.error("Failed to unsubscribe:",e),e}}getPermissionStatus(){return"Notification"in window?Notification.permission:"unsupported"}async storeSubscriptionLocally(e){try{console.log("Storing subscription locally for user:",e);const r=await this.beamsClient.getDeviceId();console.log("Device ID:",r);const n=await fetch("/api/pusher/store-subscription",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({user_id:e,device_id:r,endpoint:"pusher-beams",public_key:"pusher-beams",auth_token:"pusher-beams",content_encoding:"aesgcm"})});n.ok?console.log("Subscription stored locally"):console.error("Failed to store subscription locally:",await n.text())}catch(r){console.error("Error storing subscription locally:",r)}}}window.notificationManager=new Un;document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector('meta[name="user-id"]');if(t&&t.getAttribute("content")){const e=parseInt(t.getAttribute("content")),r=document.getElementById("enable-notifications");r&&(await Ln(e,r),r.addEventListener("click",async n=>{n.preventDefault();const s=r.textContent;r.textContent="Enabling...",r.disabled=!0;try{await window.notificationManager.subscribe(e),r.textContent="Notifications Enabled",r.classList.add("opacity-50"),localStorage.setItem("notifications-enabled","true"),alert("Push notifications enabled successfully!")}catch(i){console.error("Subscription error:",i),r.textContent=s,r.disabled=!1,alert("Failed to enable notifications: "+i.message)}}))}});async function Ln(t,e){try{const r=localStorage.getItem("notifications-enabled")==="true",n=Notification.permission==="granted",s=await fetch("/api/pusher/check-subscription",{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(s.ok){const o=(await s.json()).has_subscription;if(r&&n&&o){console.log("Auto-subscribing user to notifications...");try{await window.notificationManager.subscribe(t),e.textContent="Notifications Enabled",e.disabled=!0,e.classList.add("opacity-50"),console.log("Auto-subscription successful")}catch(a){console.log("Auto-subscription failed, user needs to re-enable:",a),localStorage.removeItem("notifications-enabled")}}}}catch(r){console.log("Could not check existing subscription:",r)}}
